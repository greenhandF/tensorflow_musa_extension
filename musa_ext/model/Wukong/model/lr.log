2026-02-07 07:10:55.125585: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/musa/lib:
2026-02-07 07:10:55.125619: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.

>>>> [MUSA] SUCCESS: MUSA Factory Object Registered via Global Constructor! <<<<
>>>> [MUSA] SUCCESS: MUSA Optimization Passes Activated! <<<<

[MUSA AMP] Optimizer module loaded (Supports FP16/BF16)
>>>> [MUSA] DeviceFactory detected 8 physical devices <<<<
2026-02-07 07:10:56.674695: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2026-02-07 07:10:56.674890: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/musa/lib:
2026-02-07 07:10:56.674902: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2026-02-07 07:10:56.674923: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (worker31066): /proc/driver/nvidia/version does not exist
2026-02-07 07:10:56.675606: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
>>>> [MUSA] DeviceFactory creating 8 logical instances <<<<
>>> [MUSA] Device 0 correctly initialized.
>>>> [MUSA] Logical Device /device:MUSA:0 created. <<<<
>>> [MUSA] Device 1 correctly initialized.
>>>> [MUSA] Logical Device /device:MUSA:1 created. <<<<
>>> [MUSA] Device 2 correctly initialized.
>>>> [MUSA] Logical Device /device:MUSA:2 created. <<<<
>>> [MUSA] Device 3 correctly initialized.
>>>> [MUSA] Logical Device /device:MUSA:3 created. <<<<
>>> [MUSA] Device 4 correctly initialized.
>>>> [MUSA] Logical Device /device:MUSA:4 created. <<<<
>>> [MUSA] Device 5 correctly initialized.
>>>> [MUSA] Logical Device /device:MUSA:5 created. <<<<
>>> [MUSA] Device 6 correctly initialized.
>>>> [MUSA] Logical Device /device:MUSA:6 created. <<<<
>>> [MUSA] Device 7 correctly initialized.
>>>> [MUSA] Logical Device /device:MUSA:7 created. <<<<
2026-02-07 07:10:57.211978: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2026-02-07 07:10:57.219265: I tensorflow/core/common_runtime/eager/execute.cc:760] Executing op Minimum in device /job:localhost/replica:0/task:0/device:MUSA:0
2026-02-07 07:10:58.838795: I tensorflow/core/common_runtime/eager/execute.cc:760] Executing op Mul in device /job:localhost/replica:0/task:0/device:MUSA:0
2026-02-07 07:10:58.839226: I tensorflow/core/common_runtime/eager/execute.cc:760] Executing op AddV2 in device /job:localhost/replica:0/task:0/device:MUSA:0
2026-02-07 07:10:58.839673: I tensorflow/core/common_runtime/eager/execute.cc:760] Executing op Minimum in device /job:localhost/replica:0/task:0/device:MUSA:0
2026-02-07 07:10:58.839748: I tensorflow/core/common_runtime/eager/execute.cc:760] Executing op Mul in device /job:localhost/replica:0/task:0/device:MUSA:0
2026-02-07 07:10:58.839795: I tensorflow/core/common_runtime/eager/execute.cc:760] Executing op AddV2 in device /job:localhost/replica:0/task:0/device:MUSA:0
2026-02-07 07:10:58.839960: I tensorflow/core/common_runtime/eager/execute.cc:760] Executing op Minimum in device /job:localhost/replica:0/task:0/device:MUSA:0
2026-02-07 07:10:58.839999: I tensorflow/core/common_runtime/eager/execute.cc:760] Executing op Mul in device /job:localhost/replica:0/task:0/device:MUSA:0
2026-02-07 07:10:58.840035: I tensorflow/core/common_runtime/eager/execute.cc:760] Executing op AddV2 in device /job:localhost/replica:0/task:0/device:MUSA:0
2026-02-07 07:10:58.840176: I tensorflow/core/common_runtime/eager/execute.cc:760] Executing op Minimum in device /job:localhost/replica:0/task:0/device:MUSA:0
2026-02-07 07:10:58.840213: I tensorflow/core/common_runtime/eager/execute.cc:760] Executing op Mul in device /job:localhost/replica:0/task:0/device:MUSA:0
2026-02-07 07:10:58.840250: I tensorflow/core/common_runtime/eager/execute.cc:760] Executing op AddV2 in device /job:localhost/replica:0/task:0/device:MUSA:0
>>>> SUCCESS: MUSA plugin loaded. <<<<
--- LinearWarmup 逻辑测试 ---
Step 0    | LR: 0.0000000100 (预期: 0.0000000100)
Step 500  | LR: 0.0020000050 (预期: 0.0020000050)
Step 1000 | LR: 0.0039999997 (预期: 0.0040000000)
Step 1500 | LR: 0.0039999997 (预期: 0.0040000000)

✅ 测试通过：线性增长与 minimum 截断逻辑完全正确。
